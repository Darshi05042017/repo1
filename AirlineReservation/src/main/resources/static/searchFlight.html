<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Search Flight</title>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" ></script>
<script>
$(function(){
	$("#tbl").hide();
	$("#searchFlight").submit(function(evt){
		evt.preventDefault();
		var obj = {
			source1 : $("#source").val(),
			destination : $("#destination").val(),
			departureDate: $("#flightDate").val(),
			fclass : $("#mySelect").val(),
			noOfPassengers : $("#passengers").val(),
			
			
		}
		sessionStorage.setItem("noOfPass",obj.noOfPassengers);
		sessionStorage.setItem("flightclass",obj.fclass);
				
		//var url="http://localhost:9090/register";
		$.ajax({
			url : "/searchFlight",//the url we wan tto hit
			method : "POST", // Get or post or any other method of Http
			data: JSON.stringify(obj), // what are we expecting back from the se
			contentType: "application/json",
			success : function(response) {
				$("#tbl").show();
								  $.each(response, function(index, flight) {
	                    var row = $("<tr/>");
	                    var col2 = $("<td/>").text(flight.companyName);
	                    col2.attr("id",flight.companyName);
	                    var source1 = $("<td/>").text(flight.source1)
	                    var col5 = $("<td/>").text(flight.destination);
	                    var col6 = $("<td/>").text(flight.duration);
	                    var col7 = $("<td/>").text(flight.departureTime);
	                    var col8 = $("<td/>").text(flight.arrivalTime);
	                    var economyPrice = $("<td/>").text(flight.economyPrice);
	                    var businessPrice= $("<td/>").text(flight.businessPrice);
	                    var col14 = $("<td/>").text(flight.seatsAvailableInBusiness);
	                    var col15 = $("<td/>").text(flight.seatsAvailableInEconomy);
	                    var button = $('<button name="flight" value='+flight.flightId+'>Select Flight</button>');
	                    button.attr("data-fid", flight.flightId);
	                    button.attr("id", flight.flightId);
	                    button.attr("class", "flight");
	                    row.append(col2);
	                    row.append(source1);
	                    row.append(col5);
	                    row.append(col6);
	                    row.append(col7);
	                    row.append(col8);
	                    row.append(economyPrice);
	                    row.append(businessPrice);
	                    row.append(col14);
	                    row.append(col15);
	                    row.append(button)
	                    $("#tbl").append(row);
	                })
	                $(function(){
	$(".flight").on( 'click',function(evt){
		evt.preventDefault();
		  var fid=$(this).val();
	      sessionStorage.setItem("flightId",fid);
	       var userid=sessionStorage.getItem("c");
	      	if (userid == 'undefined' || userid == null)
	      		window.location.replace("userLogin.html");
	      	
	      	else
	      window.location.replace("passdets3.html");
	
})
})
	                
			}
		})
	})
})


</script> 

		
</head>
<body>
<form id="searchFlight">
<div>Flight Date <br/> <input type="date" id="flightDate"/><br/></div>
<div>From <br/> <input id="source"><br/></div>
<div>To <br/> <input id="destination"><br/></div>
<div>Class <br/>  <select class="custom-select" id="mySelect">
<option id="eco" value="Economy">Economy</option>
<option id="buss" value="Business">Business</option>
</select><br/></div>
<div>No. of Passengers<br/><input id="passengers"> </div>
<button type="submit">Search</button>
</form>
<table id="tbl" style="border : 1px solid black;">
 
<tr style="border : 1px solid black;">
<th>companyName</th>
<th>source1</th>
<th>destination</th>
<th>duration</th>
<th>departureTime</th>
<th>arrivalTime</th>
<th>economyPrice</th>
<th>businessPrice</th>
<th>seatsAvailableInBusiness</th>
<th>seatsAvailableInEconomy</th>
</tr>  
</table>
</body>
</html>